#include "oui.h"
#include <string.h>
#include <stdio.h>

typedef struct {
    uint8_t prefix[3];
    const char *vendor;
} oui_entry_t;

static const oui_entry_t oui_db[] = {
    {{0x00, 0x03, 0x93}, "Apple"},
    {{0x00, 0x05, 0x02}, "Apple"},
    {{0x00, 0x0a, 0x95}, "Apple"},
    {{0x00, 0x0d, 0x93}, "Apple"},
    {{0x00, 0x16, 0xcb}, "Apple"},
    {{0x00, 0x17, 0xf2}, "Apple"},
    {{0x00, 0x19, 0xe3}, "Apple"},
    {{0x00, 0x1b, 0x63}, "Apple"},
    {{0x00, 0x1c, 0xb3}, "Apple"},
    {{0x00, 0x1d, 0x4f}, "Apple"},
    {{0x00, 0x1e, 0x52}, "Apple"},
    {{0x00, 0x1e, 0xc2}, "Apple"},
    {{0x00, 0x1f, 0x5b}, "Apple"},
    {{0x00, 0x21, 0xe9}, "Apple"},
    {{0x00, 0x22, 0x41}, "Apple"},
    {{0x00, 0x23, 0x12}, "Apple"},
    {{0x00, 0x23, 0x32}, "Apple"},
    {{0x00, 0x23, 0x6c}, "Apple"},
    {{0x00, 0x23, 0xdf}, "Apple"},
    {{0x00, 0x24, 0x36}, "Apple"},
    {{0x00, 0x25, 0x00}, "Apple"},
    {{0x00, 0x25, 0x4b}, "Apple"},
    {{0x00, 0x25, 0xbc}, "Apple"},
    {{0x00, 0x26, 0x08}, "Apple"},
    {{0x00, 0x26, 0x4a}, "Apple"},
    {{0x00, 0x26, 0xb0}, "Apple"},
    {{0x00, 0x26, 0xbb}, "Apple"},
    {{0x00, 0x50, 0xf2}, "Microsoft"},
    {{0x00, 0x0f, 0xb5}, "Microsoft"},
    {{0x00, 0x12, 0x5a}, "Microsoft"},
    {{0x00, 0x15, 0x5d}, "Microsoft"},
    {{0x00, 0x17, 0xfa}, "Microsoft"},
    {{0x00, 0x1d, 0xd8}, "Microsoft"},
    {{0x00, 0x22, 0x48}, "Microsoft"},
    {{0x00, 0x25, 0xae}, "Microsoft"},
    {{0x08, 0x00, 0x27}, "VirtualBox"},
    {{0x52, 0x54, 0x00}, "QEMU/KVM"},
    {{0x00, 0x1c, 0x14}, "Samsung"},
    {{0x00, 0x1a, 0x8a}, "Samsung"},
    {{0x00, 0x12, 0xfb}, "Samsung"},
    {{0x00, 0x15, 0xb9}, "Samsung"},
    {{0x00, 0x16, 0x32}, "Samsung"},
    {{0x00, 0x17, 0xc9}, "Samsung"},
    {{0x00, 0x18, 0xaf}, "Samsung"},
    {{0x00, 0x1b, 0x98}, "Samsung"},
    {{0x00, 0x1d, 0x25}, "Samsung"},
    {{0x00, 0x1e, 0x7d}, "Samsung"},
    {{0x00, 0x1f, 0xcd}, "Samsung"},
    {{0x00, 0x21, 0x19}, "Samsung"},
    {{0x00, 0x21, 0x4c}, "Samsung"},
    {{0x00, 0x23, 0x39}, "Samsung"},
    {{0x00, 0x23, 0xd6}, "Samsung"},
    {{0x00, 0x24, 0x90}, "Samsung"},
    {{0x00, 0x24, 0xe9}, "Samsung"},
    {{0x00, 0x25, 0x66}, "Samsung"},
    {{0x00, 0x26, 0x37}, "Samsung"},
    {{0xd8, 0x5e, 0xd3}, "Google"},
    {{0xf4, 0xf5, 0xd8}, "Google"},
    {{0x68, 0xef, 0xbd}, "Google"},
    {{0x3c, 0x5a, 0xb4}, "Google"},
    {{0x54, 0x60, 0x09}, "Google"},
    {{0xf8, 0x8f, 0xca}, "Google"},
    {{0x18, 0xb4, 0x30}, "Google"},
    {{0xac, 0x63, 0xbe}, "Google"},
    {{0x84, 0xf3, 0xeb}, "TP-Link"},
    {{0xf4, 0xec, 0x38}, "TP-Link"},
    {{0xa4, 0x2b, 0xb0}, "TP-Link"},
    {{0x50, 0xc7, 0xbf}, "TP-Link"},
    {{0x1c, 0x61, 0xb4}, "TP-Link"},
    {{0xe8, 0x48, 0xb8}, "Cisco"},
    {{0x00, 0x0a, 0xb7}, "Cisco"},
    {{0x00, 0x0b, 0xbe}, "Cisco"},
    {{0x00, 0x0c, 0x30}, "Cisco"},
    {{0x00, 0x0e, 0x38}, "Cisco"},
    {{0x00, 0x0f, 0x23}, "Cisco"},
    {{0x00, 0x1a, 0xa1}, "Cisco"},
    {{0x00, 0x1b, 0x0c}, "Cisco"},
    {{0x00, 0x1c, 0x0e}, "Cisco"},
    {{0x00, 0x1d, 0x70}, "Cisco"},
};

const char* oui_lookup(const uint8_t *mac) {
    for (size_t i = 0; i < sizeof(oui_db) / sizeof(oui_db[0]); i++) {
        if (memcmp(mac, oui_db[i].prefix, 3) == 0) {
            return oui_db[i].vendor;
        }
    }
    return "Unknown";
}
